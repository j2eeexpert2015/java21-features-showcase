<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RSA Key Transport vs KEM - Side by Side Comparison</title>
    <link rel="stylesheet" href="css/rs_vs_kem.css">
</head>
<body>
<div class="container">
    <!-- Header -->
    <div class="header">
        <h1>üîê Secure Key Establishment Comparison</h1>
        <p>RSA Key Transport vs Key Encapsulation Mechanism (KEM) - Java 21</p>
    </div>

    <!-- Main 2-Column Grid: Methods (left) | Debug (right) -->
    <div class="main-grid">
        <!-- Left Column: RSA + KEM stacked vertically -->
        <div class="methods-column">
            <!-- RSA Panel -->
            <div class="method-panel">
                <div class="panel-header rsa">
                    <h2>üî¥ RSA KEY TRANSPORT</h2>
                    <p>Traditional Method</p>
                </div>
                <div class="panel-body">
                    <!-- RSA Step 1 -->
                    <div class="step" id="rsa-step1">
                        <div class="step-header">
                            <div class="step-title-group">
                                <div class="step-status" id="rsa-step1-status">‚è∏Ô∏è</div>
                                <div class="step-title">STEP 1: Generate RSA Key Pair</div>
                            </div>
                            <button class="btn btn-rsa" id="rsa-btn-step1">Generate (2048 bits)</button>
                        </div>
                        <div class="step-content" id="rsa-step1-content" style="display: none;">
                            <div class="info-box success">
                                ‚úÖ RSA Public Key (2048 bits)<br>
                                ‚úÖ RSA Private Key (2048 bits)
                            </div>
                        </div>
                    </div>

                    <!-- RSA Step 2 -->
                    <div class="step" id="rsa-step2">
                        <div class="step-header">
                            <div class="step-title-group">
                                <div class="step-status" id="rsa-step2-status">‚è∏Ô∏è</div>
                                <div class="step-title">STEP 2: Generate Random AES Key</div>
                            </div>
                            <button class="btn btn-rsa" id="rsa-btn-step2" disabled>Generate (256 bits)</button>
                        </div>
                        <div class="step-content" id="rsa-step2-content" style="display: none;">
                            <div class="info-box success">
                                ‚úÖ AES Key Generated (256 bits = 32 bytes)
                            </div>
                            <div class="info-box danger">
                                üî¥ This key will be encrypted and transmitted
                            </div>
                            <div class="key-display" id="rsa-aes-key"></div>
                        </div>
                    </div>

                    <!-- RSA Step 3 -->
                    <div class="step" id="rsa-step3">
                        <div class="step-header">
                            <div class="step-title-group">
                                <div class="step-status" id="rsa-step3-status">‚è∏Ô∏è</div>
                                <div class="step-title">STEP 3: Encrypt AES Key with RSA</div>
                            </div>
                            <button class="btn btn-rsa" id="rsa-btn-step3" disabled>Encrypt (OAEP)</button>
                        </div>
                        <div class="step-content" id="rsa-step3-content" style="display: none;">
                            <div class="info-box warning">
                                ‚ö†Ô∏è Padding: OAEP (SHA-256 + MGF1)
                            </div>
                            <div class="info-box danger">
                                üî¥ Encrypted: 256 bytes - Contains actual key
                            </div>
                            <div class="key-display" id="rsa-encrypted-key"></div>
                        </div>
                    </div>

                    <!-- RSA Step 4 -->
                    <div class="step" id="rsa-step4">
                        <div class="step-header">
                            <div class="step-title-group">
                                <div class="step-status" id="rsa-step4-status">‚è∏Ô∏è</div>
                                <div class="step-title">STEP 4: Decrypt AES Key</div>
                            </div>
                            <button class="btn btn-rsa" id="rsa-btn-step4" disabled>Decrypt with RSA</button>
                        </div>
                        <div class="step-content" id="rsa-step4-content" style="display: none;">
                            <div class="info-box success">
                                ‚úÖ AES Key Recovered<br>
                                ‚úÖ Keys Match: <span id="rsa-match">true</span>
                            </div>
                            <div class="key-display" id="rsa-decrypted-key"></div>
                        </div>
                    </div>

                    <!-- Progress -->
                    <div class="progress-indicator">
                        <div class="progress-bar">
                            <div class="progress-fill" id="rsa-progress" style="width: 0%;"></div>
                        </div>
                        <span id="rsa-progress-text">0%</span>
                    </div>
                </div>
            </div>

            <!-- KEM Panel -->
            <div class="method-panel">
                <div class="panel-header kem">
                    <h2>üü¢ KEY ENCAPSULATION MECHANISM</h2>
                    <p>Modern Method - Java 21</p>
                </div>
                <div class="panel-body">
                    <!-- KEM Step 1 -->
                    <div class="step" id="kem-step1">
                        <div class="step-header">
                            <div class="step-title-group">
                                <div class="step-status" id="kem-step1-status">‚è∏Ô∏è</div>
                                <div class="step-title">STEP 1: Generate X25519 Key Pair</div>
                            </div>
                            <button class="btn btn-kem" id="kem-btn-step1">Generate (256 bits)</button>
                        </div>
                        <div class="step-content" id="kem-step1-content" style="display: none;">
                            <div class="info-box success">
                                ‚úÖ X25519 Public Key (256 bits)<br>
                                ‚úÖ X25519 Private Key (256 bits)
                            </div>
                        </div>
                    </div>

                    <!-- KEM Step 2 -->
                    <div class="step" id="kem-step2">
                        <div class="step-header">
                            <div class="step-title-group">
                                <div class="step-status" id="kem-step2-status">‚è∏Ô∏è</div>
                                <div class="step-title">STEP 2: KEM Encapsulation</div>
                            </div>
                            <button class="btn btn-kem" id="kem-btn-step2" disabled>Encapsulate</button>
                        </div>
                        <div class="step-content" id="kem-step2-content" style="display: none;">
                            <div class="info-box info">
                                üì¶ KEM produces TWO outputs:
                            </div>
                            <div class="info-box success">
                                ‚úÖ Shared Secret (kept local) - NEVER TRANSMITTED
                            </div>
                            <div class="key-display" id="kem-shared-secret"></div>
                            <div class="info-box success" style="margin-top: 8px;">
                                ‚úÖ Encapsulation (safe to send) - NO key material
                            </div>
                            <div class="key-display" id="kem-encapsulation"></div>
                        </div>
                    </div>

                    <!-- KEM Step 3 -->
                    <div class="step" id="kem-step3">
                        <div class="step-header">
                            <div class="step-title-group">
                                <div class="step-status" id="kem-step3-status">‚è∏Ô∏è</div>
                                <div class="step-title">STEP 3: Transmit Encapsulation</div>
                            </div>
                            <button class="btn btn-kem" id="kem-btn-step3" disabled>Transmit</button>
                        </div>
                        <div class="step-content" id="kem-step3-content" style="display: none;">
                            <div class="info-box success">
                                üì° Network: 32 bytes | Public data | NO key material | No padding
                            </div>
                        </div>
                    </div>

                    <!-- KEM Step 4 -->
                    <div class="step" id="kem-step4">
                        <div class="step-header">
                            <div class="step-title-group">
                                <div class="step-status" id="kem-step4-status">‚è∏Ô∏è</div>
                                <div class="step-title">STEP 4: KEM Decapsulation</div>
                            </div>
                            <button class="btn btn-kem" id="kem-btn-step4" disabled>Decapsulate</button>
                        </div>
                        <div class="step-content" id="kem-step4-content" style="display: none;">
                            <div class="info-box success">
                                ‚úÖ Shared Secret Derived (locally)<br>
                                ‚úÖ Secrets Match: <span id="kem-match">true</span> - Was never transmitted
                            </div>
                            <div class="key-display" id="kem-derived-secret"></div>
                        </div>
                    </div>

                    <!-- Progress -->
                    <div class="progress-indicator">
                        <div class="progress-bar">
                            <div class="progress-fill" id="kem-progress" style="width: 0%;"></div>
                        </div>
                        <span id="kem-progress-text">0%</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Column: Debug Panel (full height) -->
        <div class="debug-panel-wrapper">
            <div class="panel-header debug">
                <h2>üîß SESSION DEBUG INFO</h2>
                <p>Real-time Key Data</p>
            </div>
            <div class="debug-section-content">
                <!-- RSA Debug -->
                <div class="debug-method-block">
                    <div class="debug-method-title rsa">üî¥ RSA METHOD</div>
                    <div class="debug-item">
                        <div class="debug-label">RSA Public Key:</div>
                        <div class="debug-value" id="debug-rsa-public">Not generated yet</div>
                    </div>
                    <div class="debug-item">
                        <div class="debug-label">RSA Private Key:</div>
                        <div class="debug-value" id="debug-rsa-private">Not generated yet</div>
                    </div>
                    <div class="debug-item">
                        <div class="debug-label">üî¥ Encrypted AES Key (256 bytes):</div>
                        <div class="debug-value" id="debug-rsa-encrypted">Not generated yet</div>
                        <div class="info-box danger" style="margin-top: 3px; font-size: 9px; padding: 4px 8px;">
                            ‚ö†Ô∏è Contains actual key (encrypted)
                        </div>
                    </div>
                    <div class="debug-item">
                        <div class="debug-label">AES Key (recovered):</div>
                        <div class="debug-value" id="debug-rsa-aes">Not generated yet</div>
                    </div>
                    <div class="debug-item">
                        <div class="debug-label">IV:</div>
                        <div class="debug-value" id="debug-rsa-iv">Not generated yet</div>
                    </div>
                </div>

                <!-- KEM Debug -->
                <div class="debug-method-block">
                    <div class="debug-method-title kem">üü¢ KEM METHOD</div>
                    <div class="debug-item">
                        <div class="debug-label">X25519 Public Key:</div>
                        <div class="debug-value" id="debug-kem-public">Not generated yet</div>
                    </div>
                    <div class="debug-item">
                        <div class="debug-label">X25519 Private Key:</div>
                        <div class="debug-value" id="debug-kem-private">Not generated yet</div>
                    </div>
                    <div class="debug-item">
                        <div class="debug-label">üü¢ Encapsulation (32 bytes):</div>
                        <div class="debug-value" id="debug-kem-encapsulation">Not generated yet</div>
                        <div class="info-box success" style="margin-top: 3px; font-size: 9px; padding: 4px 8px;">
                            ‚úÖ No key material
                        </div>
                    </div>
                    <div class="debug-item">
                        <div class="debug-label">Shared Secret (derived):</div>
                        <div class="debug-value" id="debug-kem-secret">Not generated yet</div>
                    </div>
                    <div class="debug-item">
                        <div class="debug-label">IV:</div>
                        <div class="debug-value" id="debug-kem-iv">Not generated yet</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Message Encryption Section -->
    <div class="message-section">
        <h3>STEP 5: Message Encryption (Both Methods Use AES-GCM)</h3>
        <input type="text"
               class="message-input"
               id="message-input"
               placeholder="Enter message to encrypt"
               value="Hello Bob! Payment confirmed: $1,299.00 - Order #12345">
        <button class="btn btn-primary" id="btn-encrypt-both" disabled>
            Encrypt Message with Both Methods
        </button>
        <div id="encryption-results" style="display: none; margin-top: 12px;">
            <div class="info-box success">
                ‚úÖ Both methods successfully encrypted and decrypted the message
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 10px;">
                <div>
                    <h4 style="color: #e74c3c; margin-bottom: 6px; font-size: 12px;">üî¥ RSA Method</h4>
                    <div class="debug-label">Encrypted:</div>
                    <div class="debug-value" id="rsa-ciphertext"></div>
                    <div class="debug-label" style="margin-top: 6px;">Decrypted:</div>
                    <div class="debug-value" id="rsa-plaintext"></div>
                </div>
                <div>
                    <h4 style="color: #27ae60; margin-bottom: 6px; font-size: 12px;">üü¢ KEM Method</h4>
                    <div class="debug-label">Encrypted:</div>
                    <div class="debug-value" id="kem-ciphertext"></div>
                    <div class="debug-label" style="margin-top: 6px;">Decrypted:</div>
                    <div class="debug-value" id="kem-plaintext"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Reset Button -->
    <div class="reset-container">
        <button class="btn btn-reset" id="btn-reset">üîÑ Reset Both Sessions</button>
    </div>
</div>

<script src="js/rs_vs_kem.js"></script>
</body>
</html>
