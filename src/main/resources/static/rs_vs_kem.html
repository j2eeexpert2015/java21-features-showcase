<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RSA Key Transport vs KEM - Side by Side Comparison</title>
    <link rel="stylesheet" href="css/rs_vs_kem.css">
</head>
<body>
<div class="container">
    <!-- Header -->
    <div class="header">
        <h1>üîê Secure Key Establishment Comparison</h1>
        <p>RSA Key Transport vs Key Encapsulation Mechanism (KEM) - Java 21</p>
    </div>

    <!-- Legend Bar -->
    <div class="legend-bar">
        <div class="legend-group">
            <span class="legend-group-title">Parties:</span>
            <div class="legend-item">
                <span class="legend-badge sender">üì§ SENDER</span>
                <span class="legend-desc">Wants to share key</span>
            </div>
            <div class="legend-item">
                <span class="legend-badge receiver">üì• RECEIVER</span>
                <span class="legend-desc">Owns key pair</span>
            </div>
            <div class="legend-item">
                <span class="legend-badge network">üåê NETWORK</span>
                <span class="legend-desc">What gets transmitted</span>
            </div>
        </div>
        <div class="legend-group">
            <span class="legend-group-title">Cryptography:</span>
            <div class="legend-item">
                <span class="legend-badge asym">üîê ASYMMETRIC</span>
                <span class="legend-desc">Public/Private keys</span>
            </div>
            <div class="legend-item">
                <span class="legend-badge sym">üîë SYMMETRIC</span>
                <span class="legend-desc">Shared secret</span>
            </div>
        </div>
    </div>

    <!-- Main 2-Column Grid: Methods (left) | Debug (right) -->
    <div class="main-grid">
        <!-- Left Column: RSA + KEM stacked vertically -->
        <div class="methods-column">
            <!-- RSA Panel -->
            <div class="method-panel">
                <div class="panel-header rsa">
                    <h2>üî¥ RSA KEY TRANSPORT</h2>
                    <p>Traditional Method ‚Äî Encrypt & Transmit the Key</p>
                </div>
                <div class="panel-body">
                    <!-- RSA Step 1 -->
                    <div class="step" id="rsa-step1">
                        <div class="step-header">
                            <div class="step-title-group">
                                <div class="step-status" id="rsa-step1-status">‚è∏Ô∏è</div>
                                <div class="step-title">STEP 1: Generate RSA Key Pair</div>
                            </div>
                            <div class="step-labels">
                                <span class="step-badge receiver">Receiver</span>
                                <span class="step-badge asym">Asymmetric</span>
                            </div>
                            <button class="btn btn-rsa" id="rsa-btn-step1">Generate (2048 bits)</button>
                        </div>
                        <div class="step-content" id="rsa-step1-content" style="display: none;">
                            <div class="info-box success">
                                ‚úÖ RSA Public Key (2048 bits) ‚Üí shared with Sender<br>
                                ‚úÖ RSA Private Key (2048 bits) ‚Üí kept secret
                            </div>
                        </div>
                    </div>

                    <!-- RSA Step 2 -->
                    <div class="step" id="rsa-step2">
                        <div class="step-header">
                            <div class="step-title-group">
                                <div class="step-status" id="rsa-step2-status">‚è∏Ô∏è</div>
                                <div class="step-title">STEP 2: Generate Random AES Key</div>
                            </div>
                            <div class="step-labels">
                                <span class="step-badge sender">Sender</span>
                                <span class="step-badge sym">Symmetric</span>
                            </div>
                            <button class="btn btn-rsa" id="rsa-btn-step2" disabled>Generate (256 bits)</button>
                        </div>
                        <div class="step-content" id="rsa-step2-content" style="display: none;">
                            <div class="info-box success">
                                ‚úÖ AES Key Generated (256 bits = 32 bytes)
                            </div>
                            <div class="info-box danger">
                                üî¥ This symmetric key will be encrypted and transmitted
                            </div>
                            <div class="key-display" id="rsa-aes-key"></div>
                        </div>
                    </div>

                    <!-- RSA Step 3 -->
                    <div class="step" id="rsa-step3">
                        <div class="step-header">
                            <div class="step-title-group">
                                <div class="step-status" id="rsa-step3-status">‚è∏Ô∏è</div>
                                <div class="step-title">STEP 3: Encrypt AES Key with RSA</div>
                            </div>
                            <div class="step-labels">
                                <span class="step-badge sender">Sender</span>
                                <span class="step-badge network">Network</span>
                                <span class="step-badge asym">Asymmetric</span>
                            </div>
                            <button class="btn btn-rsa" id="rsa-btn-step3" disabled>Encrypt (OAEP)</button>
                        </div>
                        <div class="step-content" id="rsa-step3-content" style="display: none;">
                            <div class="info-box warning">
                                ‚ö†Ô∏è Padding: OAEP (SHA-256 + MGF1) ‚Äî must match on both sides
                            </div>
                            <div class="info-box danger">
                                üî¥ Encrypted: 256 bytes transmitted ‚Äî Contains actual key (encrypted)
                            </div>
                            <div class="key-display" id="rsa-encrypted-key"></div>
                        </div>
                    </div>

                    <!-- RSA Step 4 -->
                    <div class="step" id="rsa-step4">
                        <div class="step-header">
                            <div class="step-title-group">
                                <div class="step-status" id="rsa-step4-status">‚è∏Ô∏è</div>
                                <div class="step-title">STEP 4: Decrypt AES Key</div>
                            </div>
                            <div class="step-labels">
                                <span class="step-badge receiver">Receiver</span>
                                <span class="step-badge asym">Asymmetric</span>
                                <span class="step-badge sym">Symmetric</span>
                            </div>
                            <button class="btn btn-rsa" id="rsa-btn-step4" disabled>Decrypt with RSA</button>
                        </div>
                        <div class="step-content" id="rsa-step4-content" style="display: none;">
                            <div class="info-box success">
                                ‚úÖ AES Key Recovered ‚Äî Receiver extracted the symmetric key<br>
                                ‚úÖ Keys Match: <span id="rsa-match">true</span> ‚Äî Both parties now share the same key
                            </div>
                            <div class="key-display" id="rsa-decrypted-key"></div>
                        </div>
                    </div>

                    <!-- Progress -->
                    <div class="progress-indicator">
                        <div class="progress-bar">
                            <div class="progress-fill" id="rsa-progress" style="width: 0%;"></div>
                        </div>
                        <span id="rsa-progress-text">0%</span>
                    </div>
                </div>
            </div>

            <!-- KEM Panel -->
            <div class="method-panel">
                <div class="panel-header kem">
                    <h2>üü¢ KEY ENCAPSULATION MECHANISM</h2>
                    <p>Modern Method - Java 21 ‚Äî Derive, Don't Transmit</p>
                </div>
                <div class="panel-body">
                    <!-- KEM Step 1 -->
                    <div class="step" id="kem-step1">
                        <div class="step-header">
                            <div class="step-title-group">
                                <div class="step-status" id="kem-step1-status">‚è∏Ô∏è</div>
                                <div class="step-title">STEP 1: Generate X25519 Key Pair</div>
                            </div>
                            <div class="step-labels">
                                <span class="step-badge receiver">Receiver</span>
                                <span class="step-badge asym">Asymmetric</span>
                            </div>
                            <button class="btn btn-kem" id="kem-btn-step1">Generate (256 bits)</button>
                        </div>
                        <div class="step-content" id="kem-step1-content" style="display: none;">
                            <div class="info-box success">
                                ‚úÖ X25519 Public Key (256 bits) ‚Üí shared with Sender<br>
                                ‚úÖ X25519 Private Key (256 bits) ‚Üí kept secret
                            </div>
                        </div>
                    </div>

                    <!-- KEM Step 2 -->
                    <div class="step" id="kem-step2">
                        <div class="step-header">
                            <div class="step-title-group">
                                <div class="step-status" id="kem-step2-status">‚è∏Ô∏è</div>
                                <div class="step-title">STEP 2: KEM Encapsulation</div>
                            </div>
                            <div class="step-labels">
                                <span class="step-badge sender">Sender</span>
                                <span class="step-badge asym">Asymmetric</span>
                                <span class="step-badge sym">Symmetric</span>
                            </div>
                            <button class="btn btn-kem" id="kem-btn-step2" disabled>Encapsulate</button>
                        </div>
                        <div class="step-content" id="kem-step2-content" style="display: none;">
                            <div class="info-box info">
                                üì¶ Asymmetric operation, symmetric result. KEM produces TWO outputs:
                            </div>
                            <div class="info-box success">
                                ‚úÖ Shared Secret (kept local) ‚Äî NEVER TRANSMITTED ‚Äî Symmetric key derived
                            </div>
                            <div class="key-display" id="kem-shared-secret"></div>
                            <div class="info-box success info-box-spaced">
                                ‚úÖ Encapsulation (safe to send) ‚Äî NO key material inside
                            </div>
                            <div class="key-display" id="kem-encapsulation"></div>
                        </div>
                    </div>

                    <!-- KEM Step 3 -->
                    <div class="step" id="kem-step3">
                        <div class="step-header">
                            <div class="step-title-group">
                                <div class="step-status" id="kem-step3-status">‚è∏Ô∏è</div>
                                <div class="step-title">STEP 3: Transmit Encapsulation</div>
                            </div>
                            <div class="step-labels">
                                <span class="step-badge sender">Sender</span>
                                <span class="step-badge network">Network</span>
                            </div>
                            <button class="btn btn-kem" id="kem-btn-step3" disabled>Transmit</button>
                        </div>
                        <div class="step-content" id="kem-step3-content" style="display: none;">
                            <div class="info-box success">
                                üì° Network: 32 bytes | Public data | NO key material | No padding needed
                            </div>
                        </div>
                    </div>

                    <!-- KEM Step 4 -->
                    <div class="step" id="kem-step4">
                        <div class="step-header">
                            <div class="step-title-group">
                                <div class="step-status" id="kem-step4-status">‚è∏Ô∏è</div>
                                <div class="step-title">STEP 4: KEM Decapsulation</div>
                            </div>
                            <div class="step-labels">
                                <span class="step-badge receiver">Receiver</span>
                                <span class="step-badge asym">Asymmetric</span>
                                <span class="step-badge sym">Symmetric</span>
                            </div>
                            <button class="btn btn-kem" id="kem-btn-step4" disabled>Decapsulate</button>
                        </div>
                        <div class="step-content" id="kem-step4-content" style="display: none;">
                            <div class="info-box success">
                                ‚úÖ Shared Secret Derived (locally) ‚Äî computed independently<br>
                                ‚úÖ Secrets Match: <span id="kem-match">true</span> ‚Äî Was never transmitted!
                            </div>
                            <div class="key-display" id="kem-derived-secret"></div>
                        </div>
                    </div>

                    <!-- Progress -->
                    <div class="progress-indicator">
                        <div class="progress-bar">
                            <div class="progress-fill" id="kem-progress" style="width: 0%;"></div>
                        </div>
                        <span id="kem-progress-text">0%</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Column: Debug Panel (full height) -->
        <div class="debug-panel-wrapper">
            <div class="panel-header debug">
                <h2>üîß SESSION DEBUG INFO</h2>
                <p>Real-time Key Data ‚Äî Both Perspectives</p>
            </div>
            <div class="debug-section-content">
                <!-- RSA Debug -->
                <div class="debug-method-block">
                    <div class="debug-method-title rsa">üî¥ RSA METHOD</div>
                    <div class="debug-item">
                        <div class="debug-label">
                            RSA Public Key
                            <span class="debug-party-label receiver">Receiver</span>
                            <span class="debug-crypto-label asym">Asymmetric</span>
                            ‚Üí shared
                        </div>
                        <div class="debug-value" id="debug-rsa-public">Not generated yet</div>
                    </div>
                    <div class="debug-item">
                        <div class="debug-label">
                            RSA Private Key
                            <span class="debug-party-label receiver">Receiver</span>
                            <span class="debug-crypto-label asym">Asymmetric</span>
                            ‚Üí secret
                        </div>
                        <div class="debug-value" id="debug-rsa-private">Not generated yet</div>
                    </div>
                    <div class="debug-item">
                        <div class="debug-label">
                            AES Key (original)
                            <span class="debug-party-label sender">Sender</span>
                            <span class="debug-crypto-label sym">Symmetric</span>
                        </div>
                        <div class="debug-value" id="debug-rsa-aes">Not generated yet</div>
                    </div>
                    <div class="debug-item">
                        <div class="debug-label">
                            üî¥ Encrypted AES Key (256 bytes)
                            <span class="debug-party-label sender">Sender</span>
                            <span class="debug-party-label network">Network</span>
                        </div>
                        <div class="debug-value" id="debug-rsa-encrypted">Not generated yet</div>
                        <div class="info-box danger debug-inline-box">
                            ‚ö†Ô∏è Contains actual key (encrypted)
                        </div>
                    </div>
                    <div class="debug-item">
                        <div class="debug-label">
                            AES Key (recovered)
                            <span class="debug-party-label receiver">Receiver</span>
                            <span class="debug-crypto-label sym">Symmetric</span>
                        </div>
                        <div class="debug-value" id="debug-rsa-recovered">Not recovered yet</div>
                    </div>
                    <div class="debug-item">
                        <div class="debug-label">
                            IV (for message encryption)
                            <span class="debug-party-label sender">Sender</span>
                        </div>
                        <div class="debug-value" id="debug-rsa-iv">Not generated yet</div>
                    </div>
                </div>

                <!-- KEM Debug -->
                <div class="debug-method-block">
                    <div class="debug-method-title kem">üü¢ KEM METHOD</div>
                    <div class="debug-item">
                        <div class="debug-label">
                            X25519 Public Key
                            <span class="debug-party-label receiver">Receiver</span>
                            <span class="debug-crypto-label asym">Asymmetric</span>
                            ‚Üí shared
                        </div>
                        <div class="debug-value" id="debug-kem-public">Not generated yet</div>
                    </div>
                    <div class="debug-item">
                        <div class="debug-label">
                            X25519 Private Key
                            <span class="debug-party-label receiver">Receiver</span>
                            <span class="debug-crypto-label asym">Asymmetric</span>
                            ‚Üí secret
                        </div>
                        <div class="debug-value" id="debug-kem-private">Not generated yet</div>
                    </div>
                    <div class="debug-item">
                        <div class="debug-label">
                            Shared Secret (Sender)
                            <span class="debug-party-label sender">Sender</span>
                            <span class="debug-crypto-label sym">Symmetric</span>
                            ‚Üí LOCAL
                        </div>
                        <div class="debug-value" id="debug-kem-secret">Not generated yet</div>
                    </div>
                    <div class="debug-item">
                        <div class="debug-label">
                            üü¢ Encapsulation (32 bytes)
                            <span class="debug-party-label sender">Sender</span>
                            <span class="debug-party-label network">Network</span>
                        </div>
                        <div class="debug-value" id="debug-kem-encapsulation">Not generated yet</div>
                        <div class="info-box success debug-inline-box">
                            ‚úÖ No key material ‚Äî just mathematical parameters
                        </div>
                    </div>
                    <div class="debug-item">
                        <div class="debug-label">
                            Shared Secret (derived)
                            <span class="debug-party-label receiver">Receiver</span>
                            <span class="debug-crypto-label sym">Symmetric</span>
                            ‚Üí LOCAL
                        </div>
                        <div class="debug-value" id="debug-kem-derived">Not derived yet</div>
                    </div>
                    <div class="debug-item">
                        <div class="debug-label">
                            IV (for message encryption)
                            <span class="debug-party-label sender">Sender</span>
                        </div>
                        <div class="debug-value" id="debug-kem-iv">Not generated yet</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Message Encryption Section -->
    <div class="message-section">
        <h3>STEP 5: Message Encryption (Both Methods Use AES-GCM)</h3>
        <p class="section-subtitle">üîë Symmetric encryption ‚Äî same key encrypts & decrypts | Sender encrypts, Receiver decrypts</p>
        <input type="text"
               class="message-input"
               id="message-input"
               placeholder="Enter message to encrypt"
               value="Hello Bob! Payment confirmed: $1,299.00 - Order #12345">
        <button class="btn btn-primary" id="btn-encrypt-both" disabled>
            Sender: Encrypt Message with Both Methods
        </button>
        <div id="encryption-results" style="display: none;">
            <div class="info-box success">
                ‚úÖ Sender encrypted, Receiver decrypted ‚Äî both methods work identically once key is established
            </div>
            <div class="encryption-results-grid">
                <div>
                    <h4 class="method-result-heading rsa">üî¥ RSA Method (uses recovered AES key)</h4>
                    <div class="debug-label">Encrypted (by Sender):</div>
                    <div class="debug-value" id="rsa-ciphertext"></div>
                    <div class="debug-label debug-label-spaced">Decrypted (by Receiver):</div>
                    <div class="debug-value" id="rsa-plaintext"></div>
                </div>
                <div>
                    <h4 class="method-result-heading kem">üü¢ KEM Method (uses derived shared secret)</h4>
                    <div class="debug-label">Encrypted (by Sender):</div>
                    <div class="debug-value" id="kem-ciphertext"></div>
                    <div class="debug-label debug-label-spaced">Decrypted (by Receiver):</div>
                    <div class="debug-value" id="kem-plaintext"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Reset Button -->
    <div class="reset-container">
        <button class="btn btn-reset" id="btn-reset">üîÑ Reset Both Sessions</button>
    </div>
</div>

<script src="js/rs_vs_kem.js"></script>
</body>
</html>