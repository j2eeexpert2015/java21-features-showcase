<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Payment Processing Engine - Java 21</title>
    <link rel="stylesheet" href="css/payment_processing.css" />
</head>
<body>
<div class="header">
    <div class="connection-status">
        <div class="status-dot" id="connectionDot"></div>
        <span id="connectionText">Connecting...</span>
    </div>
    <div>
        <h1>ğŸ’³ Payment Processing Engine <span class="java-badge">JAVA 21</span></h1>
        <p class="subtitle">Interactive demonstration of Java 21 Pattern Matching for Switch with Sealed Payment Hierarchy</p>
    </div>
</div>

<div class="main-container">
    <div class="panel">
        <div class="panel-header">
            <span class="panel-icon">ğŸ›’</span>
            Order Summary
        </div>

        <div class="quick-tests">
            <button class="test-btn" onclick="setAmount(500)" data-amount="500">$500</button>
            <button class="test-btn" onclick="setAmount(1500)" data-amount="1500">$1.5K</button>
            <button class="test-btn" onclick="setAmount(5000)" data-amount="5000">$5K</button>
        </div>

        <div id="order-items">
            <div class="order-item">
                <span>iPhone 15 Pro</span>
                <span>$999</span>
            </div>
            <div class="order-item">
                <span>AirPods Pro</span>
                <span>$249</span>
            </div>
        </div>

        <div class="total">
            <div class="order-item">
                <span>Total:</span>
                <span id="total-amount">$500</span>
            </div>
        </div>

        <div class="panel-header" style="margin-top: 30px;">
            <span class="panel-icon">ğŸ’³</span>
            Payment Method
        </div>

        <div class="payment-methods">
            <div class="payment-method selected" onclick="selectPaymentMethod('credit')" data-method="credit">
                <div class="payment-icon">ğŸ’³</div>
                <div style="font-size: 12px; text-align: center;">
                    <div style="font-weight: 600;">Credit Card</div>
                    <div style="color: #6c757d;">Visa, MC, Amex</div>
                </div>
            </div>
            <div class="payment-method" onclick="selectPaymentMethod('paypal')" data-method="paypal">
                <div class="payment-icon">ğŸ“±</div>
                <div style="font-size: 12px; text-align: center;">
                    <div style="font-weight: 600;">PayPal</div>
                    <div style="color: #6c757d;">Account</div>
                </div>
            </div>
            <div class="payment-method" onclick="selectPaymentMethod('bank')" data-method="bank">
                <div class="payment-icon">ğŸ›ï¸</div>
                <div style="font-size: 12px; text-align: center;">
                    <div style="font-weight: 600;">Bank Transfer</div>
                    <div style="color: #6c757d;">Direct</div>
                </div>
            </div>
        </div>

        <div class="customer-type">
            <div style="margin-bottom: 10px; font-weight: 600; font-size: 14px;">ğŸ‘¤ Customer Type</div>
            <div class="customer-tabs">
                <button class="customer-tab" onclick="selectCustomerType('basic')" data-type="basic">Basic</button>
                <button class="customer-tab" onclick="selectCustomerType('premium')" data-type="premium">Premium</button>
                <button class="customer-tab active" onclick="selectCustomerType('vip')" data-type="vip">VIP</button>
            </div>
        </div>

        <div class="checkbox-option">
            <input type="checkbox" id="international" onchange="toggleInternational()">
            <label for="international">International Transaction</label>
        </div>
        <div style="font-size: 12px; color: #6c757d; margin-left: 20px;">
            High amounts + international = verification
        </div>

        <button class="process-btn" onclick="processPayment()" id="processBtn">ğŸ”’ Process Payment - <span id="btn-amount">$500</span></button>
    </div>

    <div class="panel">
        <div class="panel-header">
            <span class="panel-icon">âš¡</span>
            Java 21 Pattern Matching
        </div>

        <h4 style="font-size: 12px; color: #6c757d; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Pattern Matching Reference</h4>

        <div class="pattern-reference" id="pattern-reference">
            <div class="pattern-line" data-pattern="switch">
                <span class="keyword">switch</span> <span class="type">(payment)</span> <span class="comment">Pattern matching switch expression</span>
            </div>
            <div class="pattern-line" data-pattern="credit">
                <span class="keyword">case</span> <span class="type">CreditCard(...)</span> <span class="comment">Record pattern with destructuring</span>
            </div>
            <div class="pattern-line" data-pattern="paypal">
                <span class="keyword">case</span> <span class="type">PayPal(...)</span> <span class="comment">Alternative payment method pattern</span>
            </div>
            <div class="pattern-line" data-pattern="bank">
                <span class="keyword">case</span> <span class="type">BankTransfer(...)</span> <span class="comment">Bank transfer pattern matching</span>
            </div>
            <div class="pattern-line" data-pattern="guard">
                <span class="keyword">when</span> <span class="type">amount > 1000</span> <span class="comment">Guard condition for business rules</span>
            </div>
        </div>

        <div class="pattern-note">
            ğŸ’¡ Rows highlight to show the *actual* executed path.
        </div>

        <h4 style="font-size: 12px; color: #6c757d; margin-bottom: 15px; text-transform: uppercase; letter-spacing: 0.5px;">Current Pattern Status</h4>

        <div class="status-section" id="status-section">
            <div class="status-item">
                <div class="status-icon success">âœ“</div>
                <div class="status-content">
                    <h5 style="font-size: 12px !important; font-weight: bold !important; color: #333 !important;">Payment Method Detection</h5>
                    <p id="payment-detection" style="font-size: 10px !important; color: #555 !important; font-weight: 500 !important;">Pattern: CreditCard identified</p>
                </div>
            </div>

            <div class="status-item">
                <div class="status-icon success">âœ“</div>
                <div class="status-content">
                    <h5 style="font-size: 12px !important; font-weight: bold !important; color: #333 !important;">Guard Condition Check</h5>
                    <p id="guard-condition" style="font-size: 10px !important; color: #555 !important; font-weight: 500 !important;">Amount â‰¤ $1,000 â€” Standard processing</p>
                </div>
            </div>

            <div class="status-item">
                <div class="status-icon success">âœ“</div>
                <div class="status-content">
                    <h5 style="font-size: 12px !important; font-weight: bold !important; color: #333 !important;">Validation</h5>
                    <p id="validation-status" style="font-size: 10px !important; color: #555 !important; font-weight: 500 !important;">Ready for processing</p>
                </div>
            </div>

            <div class="status-item">
                <div class="status-icon play">â–¶</div>
                <div class="status-content">
                    <h5 style="font-size: 12px !important; font-weight: bold !important; color: #333 !important;">Payment Processing</h5>
                    <p id="processing-status" style="font-size: 10px !important; color: #555 !important; font-weight: 500 !important;">Click Process Payment to execute</p>
                </div>
            </div>
        </div>
    </div>

    <div class="panel">
        <div class="panel-header">
            <span class="panel-icon">ğŸ“Š</span>
            Visual Flow Inspector
            <button class="btn btn-sm btn-outline-secondary clear-log-btn" onclick="clearInspectorLog()" style="margin-left: auto; border: 1px solid #ddd; background: white; padding: 4px 8px; border-radius: 4px; font-size: 12px; cursor: pointer;">ğŸ—‘ï¸ Clear</button>
        </div>

        <div id="api-log" class="api-log-container" aria-live="polite">
            <div class="text-muted text-center py-2">Starting backend connection check...</div>
        </div>
    </div>
</div>

<script src="js/payment_processing.js"></script>
</body>
</html>